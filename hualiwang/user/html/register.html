<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="../../css/header.css">
    <link rel="stylesheet" type="text/css" href="../css/register.css">
    <link rel="stylesheet" type="text/css" href="../../css/footer.css">
</head>

<body>
    <!-- 头部 -->
    <div class="boss">
        <div class="bg_header">
            <div class="header">
                <div class="left">
                    <ul class="leftUl">
                        <li>
                            <img src="../img/icon01.png" alt="">
                            <span>收藏鲜花网(hua.com)</span>
                        </li>
                        <li>
                            <img src="../img/icon02.png" alt="">
                            <span>关注微信</span>
                        </li>
                        <li>
                            <img src="../img/icon03.png" alt="">
                            <span>花礼网app</span>
                        </li>
                    </ul>
                </div>
                <div class="right">
                    <ul class="rightUl">
                        <li>
                            <a href="./login.html">你好，请登录</a>
                            <a href="./register.html">注册</a>
                        </li>
                        <li>
                            <a href="#">订单查询</a>
                        </li>
                        <li>
                            <a href="#">我的花礼</a>
                        </li>
                        <li>
                            <a href="#">客户服务</a>
                            <img src="../img/icon07.png" alt="">
                        </li>
                        <li>
                            <a href="../../goods/html/myshoppingcar.html">
                                <img src="../img/icon06.png" alt="">
                                <span>购物车</span>
                                <span>(0)</span>
                            </a>
                            <img src="../img/icon07.png" alt="">
                        </li>
                        <li>
                            中国鲜花礼品网：中国鲜花网领先品牌
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- logol -->
        <div class="bg_top">
            <div class="topDiv">
                <div class="logol">
                    <img src="../img/logol.png" alt="">
                </div>
                <div class="center">
                    <div class="search">
                        <input type="text" class="keywords" placeholder="商品关键词">
                        <button id="search_btn">搜索</button>
                    </div>
                </div>
                <div class="serviceDiv">
                    <p>
                        <img src="../img/icon04.png" alt="">
                        <span>400-889-8188</span>
                        <img src="../img/icon05.png" alt="">
                        <span>在线客服</span>
                    </p>
                </div>
            </div>
        </div>
        <!-- 内容 -->
        <div class="bg_content">
            <div class="content">
                <p class="method">手机注册</p>
                <div class="registerDiv">
                    <div class="usertelDiv">
                        <img src="../img/icon08.png" alt="">
                        <input type="text" class="usertel" placeholder="请输入手机号">
                    </div>
                    <div class="msgcodeDiv">
                        <img src="../img/icon09.png" alt="">
                        <input type="text" class="msgcode" placeholder="请输入短信验证码">
                        <button id="code_btn">获取验证码</button>
                    </div>
                    <div class="userpwdDiv">
                        <img src="../img/icon10.png" alt="">
                        <input type="password" class="userpwd" placeholder="请输入密码">
                    </div>
                    <p class="tip"></p>
                    <button id="register_btn">注册</button>
                    <div class="itemDiv">
                        <span id="email_span" data-tag="true">邮箱注册&nbsp;></span>
                        <span id="gologin_span">已有账号，去登录&nbsp;></span>
                    </div>
                </div>
            </div>
        </div>
        <!-- 尾部 -->
        <div class="bg_footer">
            <div class="nav">
                <ul class="navUl">
                    <li>
                        <a href="../../goods/html/home.html">首页</a>
                    </li>
                    <li>
                        <a href="#">关于我们</a>
                    </li>
                    <li>
                        <a href="#">媒体报道</a>
                    </li>
                    <li>
                        <a href="#">联系方式</a>
                    </li>
                    <li>
                        <a href="#">企业团购</a>
                    </li>
                    <li>
                        <a href="#">花点入驻</a>
                    </li>
                    <li>
                        <a href="#">友情链接</a>
                    </li>
                    <li>
                        <a href="#">在线补款</a>
                    </li>
                    <li class="lastLi">
                        <a href="#">为什么选择中国鲜花礼品网</a>
                    </li>
                </ul>
            </div>
            <div class="bottom_icon">
                <img src="../img/common/bico01.png" alt="">
                <img src="../img/common/bico02.gif" alt="">
                <img src="../img/common/bico03.gif" alt="">
                <img src="../img/common/bico04.png" alt="">
                <img src="../img/common/bico05.gif" alt="">
                <img src="../img/common/bico06.jpg" alt="">
                <img src="../img/common/bico07.jpg" alt="">
                <img src="../img/common/bico08.jpg" alt="">
                <img src="../img/common/bico09.jpg" alt="">
            </div>
            <div class="bottom_msg">
                <p>中国花卉协会会员 中国电子商务协会会员 ICP经营许可证:粤B2-20050744 粤ICP备09171662号 粤公网安备44030502000373号 Copyright ©
                    2005-2019<br />
                    www.hua.com 深圳市百易信息技术有限公司 </p>
            </div>
        </div>
    </div>

</body>
<script src="../../js/jquery-1.10.1.min.js"></script>
<script>
    $("#register_btn").on("click", function () {
        var usertel = $(".usertel").val();
        var userpwd = $(".userpwd").val();
        if (usertel) {
            if (/^1\d{10}$/.test(usertel)) {
                $.ajax({
                    type: "get",
                    url: "../../php/register.php",
                    data: {
                        usertel: usertel,
                        userpwd: userpwd,
                    },
                    dataType: "json",
                    success: function (obj) {
                        if (obj["code"] == 0) {
                            $(".tip").html("该手机号已存在").css("color", "red");
                        } else {
                            location.href = "login.html";
                        }
                    }
                })
            } else {
                $(".tip").html("您输入的手机号格式不正确").css("color", "red");
            }
        } else {
            $(".tip").html("请输入手机号").css("color", "red");
        }
    });
    
    var num = 1;
    $("#email_span").click(function () {
        num++;
        if (num % 2 == 0) {
            $(".method").html("邮箱注册");
            $(".usertel").attr("placeholder", "请输入邮箱");
            $("#email_span").html("手机注册&nbsp;>");
            $(".msgcodeDiv input").attr("placeholder", "请输入验证码");
            $(".msgcodeDiv button").replaceWith("<span id='code_btn'></span>");
            randomCode();
            $("#code_btn").click(function () {
                randomCode();
            })
            $("#register_btn").on("click", function () {
                var useremail = $(".usertel").val();
                var userpwd = $(".userpwd").val();
                var msgCode = $(".msgcode").val();
                var randomCode = $(".msgcodeDiv span").html();
                if (useremail) {
                    if (/^\w+@\w+(\.\w+)+$/.test(useremail)) {
                        if (randomCode == msgCode) {
                            $.ajax({
                                type: "get",
                                url: "../../php/register1.php",
                                data: {
                                    useremail: useremail,
                                    userpwd: userpwd,
                                },
                                dataType: "json",
                                success: function (obj) {
                                    if (obj["code"] == 0) {
                                        $(".tip").html("该邮箱号已存在").css("color", "red");
                                    } else {
                                        location.href = "login.html";
                                    }
                                }
                            })
                        } else {
                            $(".tip").html("您输入的验证码有误").css("color", "red");
                        }
                    } else {
                        $(".tip").html("您输入的邮箱格式不正确").css("color", "red");
                    }
                } else {
                    $(".tip").html("请输入邮箱").css("color", "red");
                }
            });
        } else {
            $(".method").html("手机注册");
            $(".usertel").attr("placeholder", "请输入手机号");
            $("#email_span").html("邮箱注册&nbsp;>");
            $(".msgcode").attr("placeholder", "请输入短信验证码");
            $(".msgcodeDiv span").replaceWith("<button id='code_btn'>获取验证码</button>");
            $("#register_btn").on("click", function () {
                var usertel = $(".usertel").val();
                var userpwd = $(".userpwd").val();
                if (usertel) {
                    if (/^1\d{10}$/.test(usertel)) {
                        $.ajax({
                            type: "get",
                            url: "../../php/register.php",
                            data: {
                                usertel: usertel,
                                userpwd: userpwd,
                            },
                            dataType: "json",
                            success: function (obj) {
                                if (obj["code"] == 0) {
                                    $(".tip").html("该手机号已存在").css("color", "red");
                                } else {
                                    location.href = "login.html";
                                }
                            }
                        })
                    } else {
                        $(".tip").html("您输入的手机号格式不正确").css("color", "red");
                    }
                } else {
                    $(".tip").html("请输入手机号").css("color", "red");
                }
            });
        }

        function randomCode() {
            var arr = [];
            for (var i = 0; i <= 3; i++) {
                var randomCode = Math.round(Math.random() * 9);
                arr.push(randomCode)
            }
            var str = arr.join('');
            $(".msgcodeDiv #code_btn").html(str);
        }
    })

    $("#gologin_span").click(function () {
        location.href = "login.html";
    })
</script>

</html>